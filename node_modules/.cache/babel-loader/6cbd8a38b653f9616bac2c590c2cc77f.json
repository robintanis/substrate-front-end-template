{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _common = require(\"./common\");\n\nvar _config = require(\"./config\");\n/** ******************************************************************************\n *  (c) 2019 ZondaX GmbH\n *  (c) 2016-2017 Ledger\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n ******************************************************************************* */\n\n\nvar INS = {\n  GET_VERSION: 0x00,\n  GET_ADDR_ED25519: 0x01,\n  SIGN_ED25519: 0x02,\n  // Allow list related commands\n  ALLOWLIST_GET_PUBKEY: 0x90,\n  ALLOWLIST_SET_PUBKEY: 0x91,\n  ALLOWLIST_GET_HASH: 0x92,\n  ALLOWLIST_UPLOAD: 0x93\n};\n\nvar SubstrateApp = /*#__PURE__*/function () {\n  function SubstrateApp(transport, cla, slip0044) {\n    (0, _classCallCheck2.default)(this, SubstrateApp);\n\n    if (!transport) {\n      throw new Error(\"Transport has not been defined\");\n    }\n\n    this.transport = transport;\n    this.cla = cla;\n    this.slip0044 = slip0044;\n  }\n\n  (0, _createClass2.default)(SubstrateApp, [{\n    key: \"getVersion\",\n    value: function () {\n      var _getVersion2 = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee() {\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return (0, _common.getVersion)(this.transport, this.cla);\n\n              case 3:\n                return _context.abrupt(\"return\", _context.sent);\n\n              case 6:\n                _context.prev = 6;\n                _context.t0 = _context[\"catch\"](0);\n                return _context.abrupt(\"return\", (0, _common.processErrorResponse)(_context.t0));\n\n              case 9:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 6]]);\n      }));\n\n      function getVersion() {\n        return _getVersion2.apply(this, arguments);\n      }\n\n      return getVersion;\n    }()\n  }, {\n    key: \"appInfo\",\n    value: function () {\n      var _appInfo = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2() {\n        return _regenerator.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                return _context2.abrupt(\"return\", this.transport.send(0xb0, 0x01, 0, 0).then(function (response) {\n                  var errorCodeData = response.slice(-2);\n                  var returnCode = errorCodeData[0] * 256 + errorCodeData[1];\n                  var result = {};\n                  var appName = \"err\";\n                  var appVersion = \"err\";\n                  var flagLen = 0;\n                  var flagsValue = 0;\n\n                  if (response[0] !== 1) {\n                    // Ledger responds with format ID 1. There is no spec for any format != 1\n                    result.error_message = \"response format ID not recognized\";\n                    result.return_code = 0x9001;\n                  } else {\n                    var appNameLen = response[1];\n                    appName = response.slice(2, 2 + appNameLen).toString(\"ascii\");\n                    var idx = 2 + appNameLen;\n                    var appVersionLen = response[idx];\n                    idx += 1;\n                    appVersion = response.slice(idx, idx + appVersionLen).toString(\"ascii\");\n                    idx += appVersionLen;\n                    var appFlagsLen = response[idx];\n                    idx += 1;\n                    flagLen = appFlagsLen;\n                    flagsValue = response[idx];\n                  }\n\n                  return {\n                    return_code: returnCode,\n                    error_message: (0, _common.errorCodeToString)(returnCode),\n                    // //\n                    appName: appName,\n                    appVersion: appVersion,\n                    flagLen: flagLen,\n                    flagsValue: flagsValue,\n                    // eslint-disable-next-line no-bitwise\n                    flag_recovery: (flagsValue & 1) !== 0,\n                    // eslint-disable-next-line no-bitwise\n                    flag_signed_mcu_code: (flagsValue & 2) !== 0,\n                    // eslint-disable-next-line no-bitwise\n                    flag_onboarded: (flagsValue & 4) !== 0,\n                    // eslint-disable-next-line no-bitwise\n                    flag_pin_validated: (flagsValue & 128) !== 0\n                  };\n                }, _common.processErrorResponse));\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function appInfo() {\n        return _appInfo.apply(this, arguments);\n      }\n\n      return appInfo;\n    }()\n  }, {\n    key: \"getAddress\",\n    value: function () {\n      var _getAddress = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee3(account, change, addressIndex) {\n        var requireConfirmation,\n            bip44Path,\n            p1,\n            _args3 = arguments;\n        return _regenerator.default.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                requireConfirmation = _args3.length > 3 && _args3[3] !== undefined ? _args3[3] : false;\n                bip44Path = SubstrateApp.serializePath(this.slip0044, account, change, addressIndex);\n                p1 = 0;\n                if (requireConfirmation) p1 = 1;\n                return _context3.abrupt(\"return\", this.transport.send(this.cla, INS.GET_ADDR_ED25519, p1, 0, bip44Path).then(function (response) {\n                  var errorCodeData = response.slice(-2);\n                  var errorCode = errorCodeData[0] * 256 + errorCodeData[1];\n                  return {\n                    pubKey: response.slice(0, 32).toString(\"hex\"),\n                    address: response.slice(32, response.length - 2).toString(\"ascii\"),\n                    return_code: errorCode,\n                    error_message: (0, _common.errorCodeToString)(errorCode)\n                  };\n                }, _common.processErrorResponse));\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function getAddress(_x, _x2, _x3) {\n        return _getAddress.apply(this, arguments);\n      }\n\n      return getAddress;\n    }()\n  }, {\n    key: \"signSendChunk\",\n    value: function () {\n      var _signSendChunk = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee4(chunkIdx, chunkNum, chunk) {\n        var payloadType;\n        return _regenerator.default.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                payloadType = _common.PAYLOAD_TYPE.ADD;\n\n                if (chunkIdx === 1) {\n                  payloadType = _common.PAYLOAD_TYPE.INIT;\n                }\n\n                if (chunkIdx === chunkNum) {\n                  payloadType = _common.PAYLOAD_TYPE.LAST;\n                }\n\n                return _context4.abrupt(\"return\", this.transport.send(this.cla, INS.SIGN_ED25519, payloadType, 0, chunk, [_common.ERROR_CODE.NoError, 0x6984, 0x6a80]).then(function (response) {\n                  var errorCodeData = response.slice(-2);\n                  var returnCode = errorCodeData[0] * 256 + errorCodeData[1];\n                  var errorMessage = (0, _common.errorCodeToString)(returnCode);\n                  var signature = null;\n\n                  if (returnCode === 0x6a80 || returnCode === 0x6984) {\n                    errorMessage = response.slice(0, response.length - 2).toString(\"ascii\");\n                  } else if (response.length > 2) {\n                    signature = response.slice(0, response.length - 2);\n                  }\n\n                  return {\n                    signature: signature,\n                    return_code: returnCode,\n                    error_message: errorMessage\n                  };\n                }, _common.processErrorResponse));\n\n              case 4:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function signSendChunk(_x4, _x5, _x6) {\n        return _signSendChunk.apply(this, arguments);\n      }\n\n      return signSendChunk;\n    }()\n  }, {\n    key: \"sign\",\n    value: function () {\n      var _sign = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee6(account, change, addressIndex, message) {\n        var _this = this;\n\n        var chunks;\n        return _regenerator.default.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                chunks = SubstrateApp.signGetChunks(this.slip0044, account, change, addressIndex, message);\n                return _context6.abrupt(\"return\", this.signSendChunk(1, chunks.length, chunks[0]).then( /*#__PURE__*/function () {\n                  var _ref = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee5(result) {\n                    var i;\n                    return _regenerator.default.wrap(function _callee5$(_context5) {\n                      while (1) {\n                        switch (_context5.prev = _context5.next) {\n                          case 0:\n                            i = 1;\n\n                          case 1:\n                            if (!(i < chunks.length)) {\n                              _context5.next = 10;\n                              break;\n                            }\n\n                            _context5.next = 4;\n                            return _this.signSendChunk(1 + i, chunks.length, chunks[i]);\n\n                          case 4:\n                            result = _context5.sent;\n\n                            if (!(result.return_code !== _common.ERROR_CODE.NoError)) {\n                              _context5.next = 7;\n                              break;\n                            }\n\n                            return _context5.abrupt(\"break\", 10);\n\n                          case 7:\n                            i += 1;\n                            _context5.next = 1;\n                            break;\n\n                          case 10:\n                            return _context5.abrupt(\"return\", {\n                              return_code: result.return_code,\n                              error_message: result.error_message,\n                              signature: result.signature\n                            });\n\n                          case 11:\n                          case \"end\":\n                            return _context5.stop();\n                        }\n                      }\n                    }, _callee5);\n                  }));\n\n                  return function (_x11) {\n                    return _ref.apply(this, arguments);\n                  };\n                }(), _common.processErrorResponse));\n\n              case 2:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function sign(_x7, _x8, _x9, _x10) {\n        return _sign.apply(this, arguments);\n      }\n\n      return sign;\n    }() /// Allow list related commands. They are NOT available on all apps\n\n  }, {\n    key: \"getAllowlistPubKey\",\n    value: function () {\n      var _getAllowlistPubKey = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee7() {\n        return _regenerator.default.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                return _context7.abrupt(\"return\", this.transport.send(this.cla, INS.ALLOWLIST_GET_PUBKEY, 0, 0).then(function (response) {\n                  var errorCodeData = response.slice(-2);\n                  var returnCode = errorCodeData[0] * 256 + errorCodeData[1];\n                  console.log(response);\n                  var pubkey = response.slice(0, 32); // 32 bytes + 2 error code\n\n                  if (response.length !== 34) {\n                    return {\n                      return_code: 0x6984,\n                      error_message: (0, _common.errorCodeToString)(0x6984)\n                    };\n                  }\n\n                  return {\n                    return_code: returnCode,\n                    error_message: (0, _common.errorCodeToString)(returnCode),\n                    pubkey: pubkey\n                  };\n                }, _common.processErrorResponse));\n\n              case 1:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function getAllowlistPubKey() {\n        return _getAllowlistPubKey.apply(this, arguments);\n      }\n\n      return getAllowlistPubKey;\n    }()\n  }, {\n    key: \"setAllowlistPubKey\",\n    value: function () {\n      var _setAllowlistPubKey = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee8(pk) {\n        return _regenerator.default.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                return _context8.abrupt(\"return\", this.transport.send(this.cla, INS.ALLOWLIST_SET_PUBKEY, 0, 0, pk).then(function (response) {\n                  var errorCodeData = response.slice(-2);\n                  var returnCode = errorCodeData[0] * 256 + errorCodeData[1];\n                  return {\n                    return_code: returnCode,\n                    error_message: (0, _common.errorCodeToString)(returnCode)\n                  };\n                }, _common.processErrorResponse));\n\n              case 1:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function setAllowlistPubKey(_x12) {\n        return _setAllowlistPubKey.apply(this, arguments);\n      }\n\n      return setAllowlistPubKey;\n    }()\n  }, {\n    key: \"getAllowlistHash\",\n    value: function () {\n      var _getAllowlistHash = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee9() {\n        return _regenerator.default.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                return _context9.abrupt(\"return\", this.transport.send(this.cla, INS.ALLOWLIST_GET_HASH, 0, 0).then(function (response) {\n                  var errorCodeData = response.slice(-2);\n                  var returnCode = errorCodeData[0] * 256 + errorCodeData[1];\n                  console.log(response);\n                  var hash = response.slice(0, 32); // 32 bytes + 2 error code\n\n                  if (response.length !== 34) {\n                    return {\n                      return_code: 0x6984,\n                      error_message: (0, _common.errorCodeToString)(0x6984)\n                    };\n                  }\n\n                  return {\n                    return_code: returnCode,\n                    error_message: (0, _common.errorCodeToString)(returnCode),\n                    hash: hash\n                  };\n                }, _common.processErrorResponse));\n\n              case 1:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n\n      function getAllowlistHash() {\n        return _getAllowlistHash.apply(this, arguments);\n      }\n\n      return getAllowlistHash;\n    }()\n  }, {\n    key: \"uploadSendChunk\",\n    value: function () {\n      var _uploadSendChunk = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee10(chunkIdx, chunkNum, chunk) {\n        var payloadType;\n        return _regenerator.default.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                payloadType = _common.PAYLOAD_TYPE.ADD;\n\n                if (chunkIdx === 1) {\n                  payloadType = _common.PAYLOAD_TYPE.INIT;\n                }\n\n                if (chunkIdx === chunkNum) {\n                  payloadType = _common.PAYLOAD_TYPE.LAST;\n                }\n\n                return _context10.abrupt(\"return\", this.transport.send(this.cla, INS.ALLOWLIST_UPLOAD, payloadType, 0, chunk, [_common.ERROR_CODE.NoError]).then(function (response) {\n                  var errorCodeData = response.slice(-2);\n                  var returnCode = errorCodeData[0] * 256 + errorCodeData[1];\n                  var errorMessage = (0, _common.errorCodeToString)(returnCode);\n                  return {\n                    return_code: returnCode,\n                    error_message: errorMessage\n                  };\n                }, _common.processErrorResponse));\n\n              case 4:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function uploadSendChunk(_x13, _x14, _x15) {\n        return _uploadSendChunk.apply(this, arguments);\n      }\n\n      return uploadSendChunk;\n    }()\n  }, {\n    key: \"uploadAllowlist\",\n    value: function () {\n      var _uploadAllowlist = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee12(message) {\n        var _this2 = this;\n\n        var chunks;\n        return _regenerator.default.wrap(function _callee12$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                chunks = [];\n                chunks.push(Buffer.from([0]));\n                chunks.push.apply(chunks, (0, _toConsumableArray2.default)(SubstrateApp.GetChunks(message)));\n                return _context12.abrupt(\"return\", this.uploadSendChunk(1, chunks.length, chunks[0]).then( /*#__PURE__*/function () {\n                  var _ref2 = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee11(result) {\n                    var i;\n                    return _regenerator.default.wrap(function _callee11$(_context11) {\n                      while (1) {\n                        switch (_context11.prev = _context11.next) {\n                          case 0:\n                            if (!(result.return_code !== _common.ERROR_CODE.NoError)) {\n                              _context11.next = 2;\n                              break;\n                            }\n\n                            return _context11.abrupt(\"return\", {\n                              return_code: result.return_code,\n                              error_message: result.error_message\n                            });\n\n                          case 2:\n                            i = 1;\n\n                          case 3:\n                            if (!(i < chunks.length)) {\n                              _context11.next = 12;\n                              break;\n                            }\n\n                            _context11.next = 6;\n                            return _this2.uploadSendChunk(1 + i, chunks.length, chunks[i]);\n\n                          case 6:\n                            result = _context11.sent;\n\n                            if (!(result.return_code !== _common.ERROR_CODE.NoError)) {\n                              _context11.next = 9;\n                              break;\n                            }\n\n                            return _context11.abrupt(\"break\", 12);\n\n                          case 9:\n                            i += 1;\n                            _context11.next = 3;\n                            break;\n\n                          case 12:\n                            return _context11.abrupt(\"return\", {\n                              return_code: result.return_code,\n                              error_message: result.error_message\n                            });\n\n                          case 13:\n                          case \"end\":\n                            return _context11.stop();\n                        }\n                      }\n                    }, _callee11);\n                  }));\n\n                  return function (_x17) {\n                    return _ref2.apply(this, arguments);\n                  };\n                }(), _common.processErrorResponse));\n\n              case 4:\n              case \"end\":\n                return _context12.stop();\n            }\n          }\n        }, _callee12, this);\n      }));\n\n      function uploadAllowlist(_x16) {\n        return _uploadAllowlist.apply(this, arguments);\n      }\n\n      return uploadAllowlist;\n    }()\n  }], [{\n    key: \"serializePath\",\n    value: function serializePath(slip0044, account, change, addressIndex) {\n      if (!Number.isInteger(account)) throw new Error(\"Input must be an integer\");\n      if (!Number.isInteger(change)) throw new Error(\"Input must be an integer\");\n      if (!Number.isInteger(addressIndex)) throw new Error(\"Input must be an integer\");\n      var buf = Buffer.alloc(20);\n      buf.writeUInt32LE(0x8000002c, 0);\n      buf.writeUInt32LE(slip0044, 4);\n      buf.writeUInt32LE(account, 8);\n      buf.writeUInt32LE(change, 12);\n      buf.writeUInt32LE(addressIndex, 16);\n      return buf;\n    }\n  }, {\n    key: \"GetChunks\",\n    value: function GetChunks(message) {\n      var chunks = [];\n      var buffer = Buffer.from(message);\n\n      for (var i = 0; i < buffer.length; i += _common.CHUNK_SIZE) {\n        var end = i + _common.CHUNK_SIZE;\n\n        if (i > buffer.length) {\n          end = buffer.length;\n        }\n\n        chunks.push(buffer.slice(i, end));\n      }\n\n      return chunks;\n    }\n  }, {\n    key: \"signGetChunks\",\n    value: function signGetChunks(slip0044, account, change, addressIndex, message) {\n      var chunks = [];\n      var bip44Path = SubstrateApp.serializePath(slip0044, account, change, addressIndex);\n      chunks.push(bip44Path);\n      chunks.push.apply(chunks, (0, _toConsumableArray2.default)(SubstrateApp.GetChunks(message)));\n      return chunks;\n    }\n  }]);\n  return SubstrateApp;\n}();\n\nfunction newKusamaApp(transport) {\n  return new SubstrateApp(transport, _config.CLA.KUSAMA, _config.SLIP0044.KUSAMA);\n}\n\nfunction newPolkadotApp(transport) {\n  return new SubstrateApp(transport, _config.CLA.POLKADOT, _config.SLIP0044.POLKADOT);\n}\n\nmodule.exports = {\n  newKusamaApp: newKusamaApp,\n  newPolkadotApp: newPolkadotApp\n};","map":{"version":3,"sources":["/home/robin/substrate-front-end-template/node_modules/@zondax/ledger-polkadot/dist/index.js"],"names":["_interopRequireDefault","require","_toConsumableArray2","_regenerator","_asyncToGenerator2","_classCallCheck2","_createClass2","_common","_config","INS","GET_VERSION","GET_ADDR_ED25519","SIGN_ED25519","ALLOWLIST_GET_PUBKEY","ALLOWLIST_SET_PUBKEY","ALLOWLIST_GET_HASH","ALLOWLIST_UPLOAD","SubstrateApp","transport","cla","slip0044","default","Error","key","value","_getVersion2","mark","_callee","wrap","_callee$","_context","prev","next","getVersion","abrupt","sent","t0","processErrorResponse","stop","apply","arguments","_appInfo","_callee2","_callee2$","_context2","send","then","response","errorCodeData","slice","returnCode","result","appName","appVersion","flagLen","flagsValue","error_message","return_code","appNameLen","toString","idx","appVersionLen","appFlagsLen","errorCodeToString","flag_recovery","flag_signed_mcu_code","flag_onboarded","flag_pin_validated","appInfo","_getAddress","_callee3","account","change","addressIndex","requireConfirmation","bip44Path","p1","_args3","_callee3$","_context3","length","undefined","serializePath","errorCode","pubKey","address","getAddress","_x","_x2","_x3","_signSendChunk","_callee4","chunkIdx","chunkNum","chunk","payloadType","_callee4$","_context4","PAYLOAD_TYPE","ADD","INIT","LAST","ERROR_CODE","NoError","errorMessage","signature","signSendChunk","_x4","_x5","_x6","_sign","_callee6","message","_this","chunks","_callee6$","_context6","signGetChunks","_ref","_callee5","i","_callee5$","_context5","_x11","sign","_x7","_x8","_x9","_x10","_getAllowlistPubKey","_callee7","_callee7$","_context7","console","log","pubkey","getAllowlistPubKey","_setAllowlistPubKey","_callee8","pk","_callee8$","_context8","setAllowlistPubKey","_x12","_getAllowlistHash","_callee9","_callee9$","_context9","hash","getAllowlistHash","_uploadSendChunk","_callee10","_callee10$","_context10","uploadSendChunk","_x13","_x14","_x15","_uploadAllowlist","_callee12","_this2","_callee12$","_context12","push","Buffer","from","GetChunks","_ref2","_callee11","_callee11$","_context11","_x17","uploadAllowlist","_x16","Number","isInteger","buf","alloc","writeUInt32LE","buffer","CHUNK_SIZE","end","newKusamaApp","CLA","KUSAMA","SLIP0044","newPolkadotApp","POLKADOT","module","exports"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nvar _toConsumableArray2 = _interopRequireDefault(require(\"@babel/runtime/helpers/toConsumableArray\"));\n\nvar _regenerator = _interopRequireDefault(require(\"@babel/runtime/regenerator\"));\n\nvar _asyncToGenerator2 = _interopRequireDefault(require(\"@babel/runtime/helpers/asyncToGenerator\"));\n\nvar _classCallCheck2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classCallCheck\"));\n\nvar _createClass2 = _interopRequireDefault(require(\"@babel/runtime/helpers/createClass\"));\n\nvar _common = require(\"./common\");\n\nvar _config = require(\"./config\");\n\n/** ******************************************************************************\n *  (c) 2019 ZondaX GmbH\n *  (c) 2016-2017 Ledger\n *\n *  Licensed under the Apache License, Version 2.0 (the \"License\");\n *  you may not use this file except in compliance with the License.\n *  You may obtain a copy of the License at\n *\n *      http://www.apache.org/licenses/LICENSE-2.0\n *\n *  Unless required by applicable law or agreed to in writing, software\n *  distributed under the License is distributed on an \"AS IS\" BASIS,\n *  WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.\n *  See the License for the specific language governing permissions and\n *  limitations under the License.\n ******************************************************************************* */\nvar INS = {\n  GET_VERSION: 0x00,\n  GET_ADDR_ED25519: 0x01,\n  SIGN_ED25519: 0x02,\n  // Allow list related commands\n  ALLOWLIST_GET_PUBKEY: 0x90,\n  ALLOWLIST_SET_PUBKEY: 0x91,\n  ALLOWLIST_GET_HASH: 0x92,\n  ALLOWLIST_UPLOAD: 0x93\n};\n\nvar SubstrateApp = /*#__PURE__*/function () {\n  function SubstrateApp(transport, cla, slip0044) {\n    (0, _classCallCheck2.default)(this, SubstrateApp);\n\n    if (!transport) {\n      throw new Error(\"Transport has not been defined\");\n    }\n\n    this.transport = transport;\n    this.cla = cla;\n    this.slip0044 = slip0044;\n  }\n\n  (0, _createClass2.default)(SubstrateApp, [{\n    key: \"getVersion\",\n    value: function () {\n      var _getVersion2 = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee() {\n        return _regenerator.default.wrap(function _callee$(_context) {\n          while (1) {\n            switch (_context.prev = _context.next) {\n              case 0:\n                _context.prev = 0;\n                _context.next = 3;\n                return (0, _common.getVersion)(this.transport, this.cla);\n\n              case 3:\n                return _context.abrupt(\"return\", _context.sent);\n\n              case 6:\n                _context.prev = 6;\n                _context.t0 = _context[\"catch\"](0);\n                return _context.abrupt(\"return\", (0, _common.processErrorResponse)(_context.t0));\n\n              case 9:\n              case \"end\":\n                return _context.stop();\n            }\n          }\n        }, _callee, this, [[0, 6]]);\n      }));\n\n      function getVersion() {\n        return _getVersion2.apply(this, arguments);\n      }\n\n      return getVersion;\n    }()\n  }, {\n    key: \"appInfo\",\n    value: function () {\n      var _appInfo = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee2() {\n        return _regenerator.default.wrap(function _callee2$(_context2) {\n          while (1) {\n            switch (_context2.prev = _context2.next) {\n              case 0:\n                return _context2.abrupt(\"return\", this.transport.send(0xb0, 0x01, 0, 0).then(function (response) {\n                  var errorCodeData = response.slice(-2);\n                  var returnCode = errorCodeData[0] * 256 + errorCodeData[1];\n                  var result = {};\n                  var appName = \"err\";\n                  var appVersion = \"err\";\n                  var flagLen = 0;\n                  var flagsValue = 0;\n\n                  if (response[0] !== 1) {\n                    // Ledger responds with format ID 1. There is no spec for any format != 1\n                    result.error_message = \"response format ID not recognized\";\n                    result.return_code = 0x9001;\n                  } else {\n                    var appNameLen = response[1];\n                    appName = response.slice(2, 2 + appNameLen).toString(\"ascii\");\n                    var idx = 2 + appNameLen;\n                    var appVersionLen = response[idx];\n                    idx += 1;\n                    appVersion = response.slice(idx, idx + appVersionLen).toString(\"ascii\");\n                    idx += appVersionLen;\n                    var appFlagsLen = response[idx];\n                    idx += 1;\n                    flagLen = appFlagsLen;\n                    flagsValue = response[idx];\n                  }\n\n                  return {\n                    return_code: returnCode,\n                    error_message: (0, _common.errorCodeToString)(returnCode),\n                    // //\n                    appName: appName,\n                    appVersion: appVersion,\n                    flagLen: flagLen,\n                    flagsValue: flagsValue,\n                    // eslint-disable-next-line no-bitwise\n                    flag_recovery: (flagsValue & 1) !== 0,\n                    // eslint-disable-next-line no-bitwise\n                    flag_signed_mcu_code: (flagsValue & 2) !== 0,\n                    // eslint-disable-next-line no-bitwise\n                    flag_onboarded: (flagsValue & 4) !== 0,\n                    // eslint-disable-next-line no-bitwise\n                    flag_pin_validated: (flagsValue & 128) !== 0\n                  };\n                }, _common.processErrorResponse));\n\n              case 1:\n              case \"end\":\n                return _context2.stop();\n            }\n          }\n        }, _callee2, this);\n      }));\n\n      function appInfo() {\n        return _appInfo.apply(this, arguments);\n      }\n\n      return appInfo;\n    }()\n  }, {\n    key: \"getAddress\",\n    value: function () {\n      var _getAddress = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee3(account, change, addressIndex) {\n        var requireConfirmation,\n            bip44Path,\n            p1,\n            _args3 = arguments;\n        return _regenerator.default.wrap(function _callee3$(_context3) {\n          while (1) {\n            switch (_context3.prev = _context3.next) {\n              case 0:\n                requireConfirmation = _args3.length > 3 && _args3[3] !== undefined ? _args3[3] : false;\n                bip44Path = SubstrateApp.serializePath(this.slip0044, account, change, addressIndex);\n                p1 = 0;\n                if (requireConfirmation) p1 = 1;\n                return _context3.abrupt(\"return\", this.transport.send(this.cla, INS.GET_ADDR_ED25519, p1, 0, bip44Path).then(function (response) {\n                  var errorCodeData = response.slice(-2);\n                  var errorCode = errorCodeData[0] * 256 + errorCodeData[1];\n                  return {\n                    pubKey: response.slice(0, 32).toString(\"hex\"),\n                    address: response.slice(32, response.length - 2).toString(\"ascii\"),\n                    return_code: errorCode,\n                    error_message: (0, _common.errorCodeToString)(errorCode)\n                  };\n                }, _common.processErrorResponse));\n\n              case 5:\n              case \"end\":\n                return _context3.stop();\n            }\n          }\n        }, _callee3, this);\n      }));\n\n      function getAddress(_x, _x2, _x3) {\n        return _getAddress.apply(this, arguments);\n      }\n\n      return getAddress;\n    }()\n  }, {\n    key: \"signSendChunk\",\n    value: function () {\n      var _signSendChunk = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee4(chunkIdx, chunkNum, chunk) {\n        var payloadType;\n        return _regenerator.default.wrap(function _callee4$(_context4) {\n          while (1) {\n            switch (_context4.prev = _context4.next) {\n              case 0:\n                payloadType = _common.PAYLOAD_TYPE.ADD;\n\n                if (chunkIdx === 1) {\n                  payloadType = _common.PAYLOAD_TYPE.INIT;\n                }\n\n                if (chunkIdx === chunkNum) {\n                  payloadType = _common.PAYLOAD_TYPE.LAST;\n                }\n\n                return _context4.abrupt(\"return\", this.transport.send(this.cla, INS.SIGN_ED25519, payloadType, 0, chunk, [_common.ERROR_CODE.NoError, 0x6984, 0x6a80]).then(function (response) {\n                  var errorCodeData = response.slice(-2);\n                  var returnCode = errorCodeData[0] * 256 + errorCodeData[1];\n                  var errorMessage = (0, _common.errorCodeToString)(returnCode);\n                  var signature = null;\n\n                  if (returnCode === 0x6a80 || returnCode === 0x6984) {\n                    errorMessage = response.slice(0, response.length - 2).toString(\"ascii\");\n                  } else if (response.length > 2) {\n                    signature = response.slice(0, response.length - 2);\n                  }\n\n                  return {\n                    signature: signature,\n                    return_code: returnCode,\n                    error_message: errorMessage\n                  };\n                }, _common.processErrorResponse));\n\n              case 4:\n              case \"end\":\n                return _context4.stop();\n            }\n          }\n        }, _callee4, this);\n      }));\n\n      function signSendChunk(_x4, _x5, _x6) {\n        return _signSendChunk.apply(this, arguments);\n      }\n\n      return signSendChunk;\n    }()\n  }, {\n    key: \"sign\",\n    value: function () {\n      var _sign = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee6(account, change, addressIndex, message) {\n        var _this = this;\n\n        var chunks;\n        return _regenerator.default.wrap(function _callee6$(_context6) {\n          while (1) {\n            switch (_context6.prev = _context6.next) {\n              case 0:\n                chunks = SubstrateApp.signGetChunks(this.slip0044, account, change, addressIndex, message);\n                return _context6.abrupt(\"return\", this.signSendChunk(1, chunks.length, chunks[0]).then( /*#__PURE__*/function () {\n                  var _ref = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee5(result) {\n                    var i;\n                    return _regenerator.default.wrap(function _callee5$(_context5) {\n                      while (1) {\n                        switch (_context5.prev = _context5.next) {\n                          case 0:\n                            i = 1;\n\n                          case 1:\n                            if (!(i < chunks.length)) {\n                              _context5.next = 10;\n                              break;\n                            }\n\n                            _context5.next = 4;\n                            return _this.signSendChunk(1 + i, chunks.length, chunks[i]);\n\n                          case 4:\n                            result = _context5.sent;\n\n                            if (!(result.return_code !== _common.ERROR_CODE.NoError)) {\n                              _context5.next = 7;\n                              break;\n                            }\n\n                            return _context5.abrupt(\"break\", 10);\n\n                          case 7:\n                            i += 1;\n                            _context5.next = 1;\n                            break;\n\n                          case 10:\n                            return _context5.abrupt(\"return\", {\n                              return_code: result.return_code,\n                              error_message: result.error_message,\n                              signature: result.signature\n                            });\n\n                          case 11:\n                          case \"end\":\n                            return _context5.stop();\n                        }\n                      }\n                    }, _callee5);\n                  }));\n\n                  return function (_x11) {\n                    return _ref.apply(this, arguments);\n                  };\n                }(), _common.processErrorResponse));\n\n              case 2:\n              case \"end\":\n                return _context6.stop();\n            }\n          }\n        }, _callee6, this);\n      }));\n\n      function sign(_x7, _x8, _x9, _x10) {\n        return _sign.apply(this, arguments);\n      }\n\n      return sign;\n    }() /// Allow list related commands. They are NOT available on all apps\n\n  }, {\n    key: \"getAllowlistPubKey\",\n    value: function () {\n      var _getAllowlistPubKey = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee7() {\n        return _regenerator.default.wrap(function _callee7$(_context7) {\n          while (1) {\n            switch (_context7.prev = _context7.next) {\n              case 0:\n                return _context7.abrupt(\"return\", this.transport.send(this.cla, INS.ALLOWLIST_GET_PUBKEY, 0, 0).then(function (response) {\n                  var errorCodeData = response.slice(-2);\n                  var returnCode = errorCodeData[0] * 256 + errorCodeData[1];\n                  console.log(response);\n                  var pubkey = response.slice(0, 32); // 32 bytes + 2 error code\n\n                  if (response.length !== 34) {\n                    return {\n                      return_code: 0x6984,\n                      error_message: (0, _common.errorCodeToString)(0x6984)\n                    };\n                  }\n\n                  return {\n                    return_code: returnCode,\n                    error_message: (0, _common.errorCodeToString)(returnCode),\n                    pubkey: pubkey\n                  };\n                }, _common.processErrorResponse));\n\n              case 1:\n              case \"end\":\n                return _context7.stop();\n            }\n          }\n        }, _callee7, this);\n      }));\n\n      function getAllowlistPubKey() {\n        return _getAllowlistPubKey.apply(this, arguments);\n      }\n\n      return getAllowlistPubKey;\n    }()\n  }, {\n    key: \"setAllowlistPubKey\",\n    value: function () {\n      var _setAllowlistPubKey = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee8(pk) {\n        return _regenerator.default.wrap(function _callee8$(_context8) {\n          while (1) {\n            switch (_context8.prev = _context8.next) {\n              case 0:\n                return _context8.abrupt(\"return\", this.transport.send(this.cla, INS.ALLOWLIST_SET_PUBKEY, 0, 0, pk).then(function (response) {\n                  var errorCodeData = response.slice(-2);\n                  var returnCode = errorCodeData[0] * 256 + errorCodeData[1];\n                  return {\n                    return_code: returnCode,\n                    error_message: (0, _common.errorCodeToString)(returnCode)\n                  };\n                }, _common.processErrorResponse));\n\n              case 1:\n              case \"end\":\n                return _context8.stop();\n            }\n          }\n        }, _callee8, this);\n      }));\n\n      function setAllowlistPubKey(_x12) {\n        return _setAllowlistPubKey.apply(this, arguments);\n      }\n\n      return setAllowlistPubKey;\n    }()\n  }, {\n    key: \"getAllowlistHash\",\n    value: function () {\n      var _getAllowlistHash = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee9() {\n        return _regenerator.default.wrap(function _callee9$(_context9) {\n          while (1) {\n            switch (_context9.prev = _context9.next) {\n              case 0:\n                return _context9.abrupt(\"return\", this.transport.send(this.cla, INS.ALLOWLIST_GET_HASH, 0, 0).then(function (response) {\n                  var errorCodeData = response.slice(-2);\n                  var returnCode = errorCodeData[0] * 256 + errorCodeData[1];\n                  console.log(response);\n                  var hash = response.slice(0, 32); // 32 bytes + 2 error code\n\n                  if (response.length !== 34) {\n                    return {\n                      return_code: 0x6984,\n                      error_message: (0, _common.errorCodeToString)(0x6984)\n                    };\n                  }\n\n                  return {\n                    return_code: returnCode,\n                    error_message: (0, _common.errorCodeToString)(returnCode),\n                    hash: hash\n                  };\n                }, _common.processErrorResponse));\n\n              case 1:\n              case \"end\":\n                return _context9.stop();\n            }\n          }\n        }, _callee9, this);\n      }));\n\n      function getAllowlistHash() {\n        return _getAllowlistHash.apply(this, arguments);\n      }\n\n      return getAllowlistHash;\n    }()\n  }, {\n    key: \"uploadSendChunk\",\n    value: function () {\n      var _uploadSendChunk = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee10(chunkIdx, chunkNum, chunk) {\n        var payloadType;\n        return _regenerator.default.wrap(function _callee10$(_context10) {\n          while (1) {\n            switch (_context10.prev = _context10.next) {\n              case 0:\n                payloadType = _common.PAYLOAD_TYPE.ADD;\n\n                if (chunkIdx === 1) {\n                  payloadType = _common.PAYLOAD_TYPE.INIT;\n                }\n\n                if (chunkIdx === chunkNum) {\n                  payloadType = _common.PAYLOAD_TYPE.LAST;\n                }\n\n                return _context10.abrupt(\"return\", this.transport.send(this.cla, INS.ALLOWLIST_UPLOAD, payloadType, 0, chunk, [_common.ERROR_CODE.NoError]).then(function (response) {\n                  var errorCodeData = response.slice(-2);\n                  var returnCode = errorCodeData[0] * 256 + errorCodeData[1];\n                  var errorMessage = (0, _common.errorCodeToString)(returnCode);\n                  return {\n                    return_code: returnCode,\n                    error_message: errorMessage\n                  };\n                }, _common.processErrorResponse));\n\n              case 4:\n              case \"end\":\n                return _context10.stop();\n            }\n          }\n        }, _callee10, this);\n      }));\n\n      function uploadSendChunk(_x13, _x14, _x15) {\n        return _uploadSendChunk.apply(this, arguments);\n      }\n\n      return uploadSendChunk;\n    }()\n  }, {\n    key: \"uploadAllowlist\",\n    value: function () {\n      var _uploadAllowlist = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee12(message) {\n        var _this2 = this;\n\n        var chunks;\n        return _regenerator.default.wrap(function _callee12$(_context12) {\n          while (1) {\n            switch (_context12.prev = _context12.next) {\n              case 0:\n                chunks = [];\n                chunks.push(Buffer.from([0]));\n                chunks.push.apply(chunks, (0, _toConsumableArray2.default)(SubstrateApp.GetChunks(message)));\n                return _context12.abrupt(\"return\", this.uploadSendChunk(1, chunks.length, chunks[0]).then( /*#__PURE__*/function () {\n                  var _ref2 = (0, _asyncToGenerator2.default)( /*#__PURE__*/_regenerator.default.mark(function _callee11(result) {\n                    var i;\n                    return _regenerator.default.wrap(function _callee11$(_context11) {\n                      while (1) {\n                        switch (_context11.prev = _context11.next) {\n                          case 0:\n                            if (!(result.return_code !== _common.ERROR_CODE.NoError)) {\n                              _context11.next = 2;\n                              break;\n                            }\n\n                            return _context11.abrupt(\"return\", {\n                              return_code: result.return_code,\n                              error_message: result.error_message\n                            });\n\n                          case 2:\n                            i = 1;\n\n                          case 3:\n                            if (!(i < chunks.length)) {\n                              _context11.next = 12;\n                              break;\n                            }\n\n                            _context11.next = 6;\n                            return _this2.uploadSendChunk(1 + i, chunks.length, chunks[i]);\n\n                          case 6:\n                            result = _context11.sent;\n\n                            if (!(result.return_code !== _common.ERROR_CODE.NoError)) {\n                              _context11.next = 9;\n                              break;\n                            }\n\n                            return _context11.abrupt(\"break\", 12);\n\n                          case 9:\n                            i += 1;\n                            _context11.next = 3;\n                            break;\n\n                          case 12:\n                            return _context11.abrupt(\"return\", {\n                              return_code: result.return_code,\n                              error_message: result.error_message\n                            });\n\n                          case 13:\n                          case \"end\":\n                            return _context11.stop();\n                        }\n                      }\n                    }, _callee11);\n                  }));\n\n                  return function (_x17) {\n                    return _ref2.apply(this, arguments);\n                  };\n                }(), _common.processErrorResponse));\n\n              case 4:\n              case \"end\":\n                return _context12.stop();\n            }\n          }\n        }, _callee12, this);\n      }));\n\n      function uploadAllowlist(_x16) {\n        return _uploadAllowlist.apply(this, arguments);\n      }\n\n      return uploadAllowlist;\n    }()\n  }], [{\n    key: \"serializePath\",\n    value: function serializePath(slip0044, account, change, addressIndex) {\n      if (!Number.isInteger(account)) throw new Error(\"Input must be an integer\");\n      if (!Number.isInteger(change)) throw new Error(\"Input must be an integer\");\n      if (!Number.isInteger(addressIndex)) throw new Error(\"Input must be an integer\");\n      var buf = Buffer.alloc(20);\n      buf.writeUInt32LE(0x8000002c, 0);\n      buf.writeUInt32LE(slip0044, 4);\n      buf.writeUInt32LE(account, 8);\n      buf.writeUInt32LE(change, 12);\n      buf.writeUInt32LE(addressIndex, 16);\n      return buf;\n    }\n  }, {\n    key: \"GetChunks\",\n    value: function GetChunks(message) {\n      var chunks = [];\n      var buffer = Buffer.from(message);\n\n      for (var i = 0; i < buffer.length; i += _common.CHUNK_SIZE) {\n        var end = i + _common.CHUNK_SIZE;\n\n        if (i > buffer.length) {\n          end = buffer.length;\n        }\n\n        chunks.push(buffer.slice(i, end));\n      }\n\n      return chunks;\n    }\n  }, {\n    key: \"signGetChunks\",\n    value: function signGetChunks(slip0044, account, change, addressIndex, message) {\n      var chunks = [];\n      var bip44Path = SubstrateApp.serializePath(slip0044, account, change, addressIndex);\n      chunks.push(bip44Path);\n      chunks.push.apply(chunks, (0, _toConsumableArray2.default)(SubstrateApp.GetChunks(message)));\n      return chunks;\n    }\n  }]);\n  return SubstrateApp;\n}();\n\nfunction newKusamaApp(transport) {\n  return new SubstrateApp(transport, _config.CLA.KUSAMA, _config.SLIP0044.KUSAMA);\n}\n\nfunction newPolkadotApp(transport) {\n  return new SubstrateApp(transport, _config.CLA.POLKADOT, _config.SLIP0044.POLKADOT);\n}\n\nmodule.exports = {\n  newKusamaApp: newKusamaApp,\n  newPolkadotApp: newPolkadotApp\n};"]},"metadata":{},"sourceType":"script"}