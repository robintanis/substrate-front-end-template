{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.account = account;\n\nvar _rxjs = require(\"rxjs\");\n\nvar _operators = require(\"rxjs/operators\");\n\nvar _util = require(\"@polkadot/util\");\n\nvar _util2 = require(\"../util\"); // Copyright 2017-2020 @polkadot/api-derive authors & contributors\n// SPDX-License-Identifier: Apache-2.0\n\n\nfunction calcBalances(api, [accountId, [freeBalance, reservedBalance, frozenFee, frozenMisc, accountNonce]]) {\n  return {\n    accountId,\n    accountNonce,\n    freeBalance,\n    frozenFee,\n    frozenMisc,\n    reservedBalance,\n    votingBalance: api.registry.createType('Balance', freeBalance.toBn())\n  };\n} // old\n\n\nfunction queryBalancesFree(api, accountId) {\n  return api.queryMulti([[api.query.balances.freeBalance, accountId], [api.query.balances.reservedBalance, accountId], [api.query.system.accountNonce, accountId]]).pipe((0, _operators.map)(([freeBalance, reservedBalance, accountNonce]) => [freeBalance, reservedBalance, api.registry.createType('Balance'), api.registry.createType('Balance'), accountNonce]));\n}\n\nfunction queryBalancesAccount(api, accountId) {\n  return api.queryMulti([[api.query.balances.account, accountId], [api.query.system.accountNonce, accountId]]).pipe((0, _operators.map)(([{\n    feeFrozen,\n    free,\n    miscFrozen,\n    reserved\n  }, accountNonce]) => [free, reserved, feeFrozen, miscFrozen, accountNonce]));\n}\n\nfunction queryCurrent(api, accountId) {\n  // AccountInfo is current, support old, eg. Edgeware\n  return api.query.system.account(accountId).pipe((0, _operators.map)(infoOrTuple => {\n    const {\n      feeFrozen,\n      free,\n      miscFrozen,\n      reserved\n    } = infoOrTuple.nonce ? infoOrTuple.data : infoOrTuple[1];\n    const accountNonce = infoOrTuple.nonce || infoOrTuple[0];\n    return [free, reserved, feeFrozen, miscFrozen, accountNonce];\n  }));\n}\n/**\n * @name account\n * @param {( AccountIndex | AccountId | Address | string )} address - An accounts Id in different formats.\n * @returns An object containing the results of various balance queries\n * @example\n * <BR>\n *\n * ```javascript\n * const ALICE = 'F7Hs';\n *\n * api.derive.balances.all(ALICE, ({ accountId, lockedBalance }) => {\n *   console.log(`The account ${accountId} has a locked balance ${lockedBalance} units.`);\n * });\n * ```\n */\n\n\nfunction account(instanceId, api) {\n  return (0, _util2.memo)(instanceId, address => api.derive.accounts.accountId(address).pipe((0, _operators.switchMap)(accountId => accountId ? (0, _rxjs.combineLatest)([(0, _rxjs.of)(accountId), (0, _util.isFunction)(api.query.system.account) ? queryCurrent(api, accountId) : (0, _util.isFunction)(api.query.balances.account) ? queryBalancesAccount(api, accountId) : queryBalancesFree(api, accountId)]) : (0, _rxjs.of)([api.registry.createType('AccountId'), [api.registry.createType('Balance'), api.registry.createType('Balance'), api.registry.createType('Balance'), api.registry.createType('Balance'), api.registry.createType('Index')]])), (0, _operators.map)(result => calcBalances(api, result))));\n}","map":{"version":3,"sources":["/home/robin/substrate-front-end-template/node_modules/@polkadot/api-derive/balances/account.js"],"names":["Object","defineProperty","exports","value","account","_rxjs","require","_operators","_util","_util2","calcBalances","api","accountId","freeBalance","reservedBalance","frozenFee","frozenMisc","accountNonce","votingBalance","registry","createType","toBn","queryBalancesFree","queryMulti","query","balances","system","pipe","map","queryBalancesAccount","feeFrozen","free","miscFrozen","reserved","queryCurrent","infoOrTuple","nonce","data","instanceId","memo","address","derive","accounts","switchMap","combineLatest","of","isFunction","result"],"mappings":"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","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.account = account;\n\nvar _rxjs = require(\"rxjs\");\n\nvar _operators = require(\"rxjs/operators\");\n\nvar _util = require(\"@polkadot/util\");\n\nvar _util2 = require(\"../util\");\n\n// Copyright 2017-2020 @polkadot/api-derive authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nfunction calcBalances(api, [accountId, [freeBalance, reservedBalance, frozenFee, frozenMisc, accountNonce]]) {\n  return {\n    accountId,\n    accountNonce,\n    freeBalance,\n    frozenFee,\n    frozenMisc,\n    reservedBalance,\n    votingBalance: api.registry.createType('Balance', freeBalance.toBn())\n  };\n} // old\n\n\nfunction queryBalancesFree(api, accountId) {\n  return api.queryMulti([[api.query.balances.freeBalance, accountId], [api.query.balances.reservedBalance, accountId], [api.query.system.accountNonce, accountId]]).pipe((0, _operators.map)(([freeBalance, reservedBalance, accountNonce]) => [freeBalance, reservedBalance, api.registry.createType('Balance'), api.registry.createType('Balance'), accountNonce]));\n}\n\nfunction queryBalancesAccount(api, accountId) {\n  return api.queryMulti([[api.query.balances.account, accountId], [api.query.system.accountNonce, accountId]]).pipe((0, _operators.map)(([{\n    feeFrozen,\n    free,\n    miscFrozen,\n    reserved\n  }, accountNonce]) => [free, reserved, feeFrozen, miscFrozen, accountNonce]));\n}\n\nfunction queryCurrent(api, accountId) {\n  // AccountInfo is current, support old, eg. Edgeware\n  return api.query.system.account(accountId).pipe((0, _operators.map)(infoOrTuple => {\n    const {\n      feeFrozen,\n      free,\n      miscFrozen,\n      reserved\n    } = infoOrTuple.nonce ? infoOrTuple.data : infoOrTuple[1];\n    const accountNonce = infoOrTuple.nonce || infoOrTuple[0];\n    return [free, reserved, feeFrozen, miscFrozen, accountNonce];\n  }));\n}\n/**\n * @name account\n * @param {( AccountIndex | AccountId | Address | string )} address - An accounts Id in different formats.\n * @returns An object containing the results of various balance queries\n * @example\n * <BR>\n *\n * ```javascript\n * const ALICE = 'F7Hs';\n *\n * api.derive.balances.all(ALICE, ({ accountId, lockedBalance }) => {\n *   console.log(`The account ${accountId} has a locked balance ${lockedBalance} units.`);\n * });\n * ```\n */\n\n\nfunction account(instanceId, api) {\n  return (0, _util2.memo)(instanceId, address => api.derive.accounts.accountId(address).pipe((0, _operators.switchMap)(accountId => accountId ? (0, _rxjs.combineLatest)([(0, _rxjs.of)(accountId), (0, _util.isFunction)(api.query.system.account) ? queryCurrent(api, accountId) : (0, _util.isFunction)(api.query.balances.account) ? queryBalancesAccount(api, accountId) : queryBalancesFree(api, accountId)]) : (0, _rxjs.of)([api.registry.createType('AccountId'), [api.registry.createType('Balance'), api.registry.createType('Balance'), api.registry.createType('Balance'), api.registry.createType('Balance'), api.registry.createType('Index')]])), (0, _operators.map)(result => calcBalances(api, result))));\n}"]},"metadata":{},"sourceType":"script"}