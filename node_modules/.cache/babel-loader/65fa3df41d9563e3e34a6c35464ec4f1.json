{"ast":null,"code":"\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _classPrivateFieldLooseBase2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classPrivateFieldLooseBase\"));\n\nvar _classPrivateFieldLooseKey2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classPrivateFieldLooseKey\"));\n\nvar _bn = _interopRequireDefault(require(\"bn.js\"));\n\nvar _rxjs = require(\"rxjs\");\n\nvar _operators = require(\"rxjs/operators\");\n\nvar _apiDerive = _interopRequireDefault(require(\"@polkadot/api-derive\"));\n\nvar _util = require(\"@polkadot/api-derive/util\");\n\nvar _Decorated = _interopRequireDefault(require(\"@polkadot/metadata/Decorated\"));\n\nvar _rpcCore = _interopRequireDefault(require(\"@polkadot/rpc-core\"));\n\nvar _rpcProvider = require(\"@polkadot/rpc-provider\");\n\nvar _types = require(\"@polkadot/types\");\n\nvar _constants = require(\"@polkadot/types/extrinsic/constants\");\n\nvar _StorageKey = require(\"@polkadot/types/primitive/StorageKey\");\n\nvar _util2 = require(\"@polkadot/util\");\n\nvar _submittable = require(\"../submittable\");\n\nvar _augmentObject = _interopRequireDefault(require(\"../util/augmentObject\"));\n\nvar _decorate = require(\"../util/decorate\");\n\nvar _validate = require(\"../util/validate\");\n\nvar _Events = _interopRequireDefault(require(\"./Events\")); // Copyright 2017-2020 @polkadot/api authors & contributors\n// SPDX-License-Identifier: Apache-2.0\n\n\nconst PAGE_SIZE_KEYS = 256;\nconst PAGE_SIZE_VALS = PAGE_SIZE_KEYS;\nconst l = (0, _util2.logger)('api/init');\nlet instanceCounter = 0;\n\nvar _instanceId = (0, _classPrivateFieldLooseKey2.default)(\"instanceId\");\n\nvar _registry = (0, _classPrivateFieldLooseKey2.default)(\"registry\");\n\nclass Decorate extends _Events.default {\n  // HACK Use BN import so decorateDerive works... yes, wtf.\n\n  /**\n   * This is the one and only method concrete children classes need to implement.\n   * It's a higher-order function, which takes one argument\n   * `method: Method extends (...args: any[]) => Observable<any>`\n   * (and one optional `options`), and should return the user facing method.\n   * For example:\n   * - For ApiRx, `decorateMethod` should just be identity, because the input\n   * function is already an Observable\n   * - For ApiPromise, `decorateMethod` should return a function that takes all\n   * the parameters from `method`, adds an optional `callback` argument, and\n   * returns a Promise.\n   *\n   * We could easily imagine other user-facing interfaces, which are simply\n   * implemented by transforming the Observable to Stream/Iterator/Kefir/Bacon\n   * via `decorateMethod`.\n   */\n\n  /**\n   * @description Create an instance of the class\n   *\n   * @param options Options object to create API instance or a Provider instance\n   *\n   * @example\n   * <BR>\n   *\n   * ```javascript\n   * import Api from '@polkadot/api/promise';\n   *\n   * const api = new Api().isReady();\n   *\n   * api.rpc.subscribeNewHeads((header) => {\n   *   console.log(`new block #${header.number.toNumber()}`);\n   * });\n   * ```\n   */\n  constructor(options, type, decorateMethod) {\n    var _options$source;\n\n    super();\n    Object.defineProperty(this, _instanceId, {\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, _registry, {\n      writable: true,\n      value: void 0\n    });\n    this.__phantom = new _bn.default(0);\n    this._consts = {};\n    this._derive = void 0;\n    this._extrinsics = void 0;\n    this._extrinsicType = _constants.DEFAULT_VERSION;\n    this._genesisHash = void 0;\n    this._isConnected = void 0;\n    this._isReady = false;\n    this._options = void 0;\n    this._query = {};\n    this._queryMulti = void 0;\n    this._rpc = void 0;\n    this._rpcCore = void 0;\n    this._runtimeChain = void 0;\n    this._runtimeMetadata = void 0;\n    this._runtimeVersion = void 0;\n    this._rx = {\n      consts: {},\n      query: {},\n      tx: {}\n    };\n    this._type = void 0;\n    this._decorateMethod = void 0;\n\n    this._rxDecorateMethod = method => {\n      return method;\n    };\n\n    (0, _classPrivateFieldLooseBase2.default)(this, _instanceId)[_instanceId] = `${++instanceCounter}`;\n    (0, _classPrivateFieldLooseBase2.default)(this, _registry)[_registry] = ((_options$source = options.source) === null || _options$source === void 0 ? void 0 : _options$source.registry) || options.registry || new _types.TypeRegistry();\n    const thisProvider = options.source ? options.source._rpcCore.provider.clone() : options.provider || new _rpcProvider.WsProvider();\n    this._decorateMethod = decorateMethod;\n    this._options = options;\n    this._type = type;\n    this._rpcCore = new _rpcCore.default((0, _classPrivateFieldLooseBase2.default)(this, _instanceId)[_instanceId], (0, _classPrivateFieldLooseBase2.default)(this, _registry)[_registry], thisProvider, this._options.rpc);\n    this._isConnected = new _rxjs.BehaviorSubject(this._rpcCore.provider.isConnected);\n    this._rx.hasSubscriptions = this._rpcCore.provider.hasSubscriptions;\n    this._rx.registry = (0, _classPrivateFieldLooseBase2.default)(this, _registry)[_registry];\n  }\n  /**\n   * @description Return the current used registry\n   */\n\n\n  get registry() {\n    return (0, _classPrivateFieldLooseBase2.default)(this, _registry)[_registry];\n  }\n  /**\n   * @description Creates an instance of a type as registered\n   */\n\n\n  createType(type, ...params) {\n    return (0, _classPrivateFieldLooseBase2.default)(this, _registry)[_registry].createType(type, ...params);\n  }\n  /**\n   * @description Register additional user-defined of chain-specific types in the type registry\n   */\n\n\n  registerTypes(types) {\n    types && (0, _classPrivateFieldLooseBase2.default)(this, _registry)[_registry].register(types);\n  }\n  /**\n   * @returns `true` if the API operates with subscriptions\n   */\n\n\n  get hasSubscriptions() {\n    return this._rpcCore.provider.hasSubscriptions;\n  }\n\n  injectMetadata(metadata, fromEmpty, registry) {\n    const decoratedMeta = new _Decorated.default(registry || (0, _classPrivateFieldLooseBase2.default)(this, _registry)[_registry], metadata);\n\n    if (fromEmpty || !this._extrinsics) {\n      this._extrinsics = this._decorateExtrinsics(decoratedMeta.tx, this._decorateMethod);\n      this._rx.tx = this._decorateExtrinsics(decoratedMeta.tx, this._rxDecorateMethod);\n    } else {\n      (0, _augmentObject.default)('tx', this._decorateExtrinsics(decoratedMeta.tx, this._decorateMethod), this._extrinsics, false);\n      (0, _augmentObject.default)(null, this._decorateExtrinsics(decoratedMeta.tx, this._rxDecorateMethod), this._rx.tx, false);\n    } // this API\n\n\n    (0, _augmentObject.default)('query', this._decorateStorage(decoratedMeta.query, this._decorateMethod), this._query, fromEmpty);\n    (0, _augmentObject.default)('consts', decoratedMeta.consts, this._consts, fromEmpty); // rx\n\n    (0, _augmentObject.default)(null, this._decorateStorage(decoratedMeta.query, this._rxDecorateMethod), this._rx.query, fromEmpty);\n    (0, _augmentObject.default)(null, decoratedMeta.consts, this._rx.consts, fromEmpty);\n  }\n\n  _decorateFunctionMeta(input, output) {\n    output.meta = input.meta;\n    output.method = input.method;\n    output.section = input.section;\n    output.toJSON = input.toJSON;\n\n    if (input.callIndex) {\n      output.callIndex = input.callIndex;\n    }\n\n    return output;\n  } // Filter all RPC methods based on the results of the rpc_methods call. We do this in the following\n  // manner to cater for both old and new:\n  //   - when the number of entries are 0, only remove the ones with isOptional (account & contracts)\n  //   - when non-zero, remove anything that is not in the array (we don't do this)\n\n\n  async _filterRpc() {\n    let methods;\n\n    try {\n      // we ignore the version (adjust as versions change, for now only \"1\")\n      methods = (await this._rpcCore.rpc.methods().toPromise()).methods.map(t => t.toString());\n    } catch (error) {\n      // the method is not there, we adjust accordingly\n      methods = [];\n    }\n\n    this._filterRpcMethods(methods);\n  }\n\n  _filterRpcMethods(exposed) {\n    const hasResults = exposed.length !== 0;\n    const allKnown = [...this._rpcCore.mapping.entries()];\n    const allKeys = allKnown.reduce((allKeys, [, {\n      alias,\n      method,\n      pubsub,\n      section\n    }]) => {\n      allKeys.push(`${section}_${method}`);\n\n      if (pubsub) {\n        allKeys.push(`${section}_${pubsub[1]}`);\n        allKeys.push(`${section}_${pubsub[2]}`);\n      }\n\n      if (alias) {\n        allKeys.push(...alias);\n      }\n\n      return allKeys;\n    }, []);\n    const unknown = exposed.filter(key => !allKeys.includes(key));\n\n    if (unknown.length) {\n      l.warn(`RPC methods not decorated: ${unknown.join(', ')}`);\n    } // loop through all entries we have (populated in decorate) and filter as required\n    // only remove when we have results and method missing, or with no results if optional\n\n\n    allKnown.filter(([key]) => hasResults ? !exposed.includes(key) && key !== 'rpc_methods' // rpc_methods doesn't appear, v1\n    : key === 'rpc_methods' // we didn't find this one, remove\n    ) // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    .forEach(([_, {\n      method,\n      section\n    }]) => {\n      delete this._rpc[section][method];\n      delete this._rpcCore[section][method];\n      delete this._rx.rpc[section][method];\n    });\n  }\n\n  _decorateRpc(rpc, decorateMethod) {\n    return rpc.sections.reduce((out, _sectionName) => {\n      const sectionName = _sectionName; // out and section here are horrors to get right from a typing perspective :(\n\n      out[sectionName] = Object.entries(rpc[sectionName]).reduce((section, [methodName, method]) => {\n        //  skip subscriptions where we have a non-subscribe interface\n        if (this.hasSubscriptions || !(methodName.startsWith('subscribe') || methodName.startsWith('unsubscribe'))) {\n          section[methodName] = decorateMethod(method, {\n            methodName\n          }); // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n\n          section[methodName].raw = decorateMethod(method.raw, {\n            methodName\n          });\n        }\n\n        return section;\n      }, {});\n      return out;\n    }, {});\n  }\n\n  _decorateMulti(decorateMethod) {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n    return decorateMethod(calls => this._rpcCore.state.subscribeStorage(calls.map(arg => // the input is a QueryableStorageEntry, convert to StorageEntry\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n    Array.isArray(arg) ? [arg[0].creator, ...arg.slice(1)] : [arg.creator])));\n  }\n\n  _decorateExtrinsics(extrinsics, decorateMethod) {\n    const creator = (0, _submittable.createSubmittable)(this._type, this._rx, decorateMethod);\n    return Object.entries(extrinsics).reduce((out, [name, section]) => {\n      out[name] = Object.entries(section).reduce((out, [name, method]) => {\n        out[name] = this._decorateExtrinsicEntry(method, creator);\n        return out;\n      }, {});\n      return out;\n    }, creator);\n  }\n\n  _decorateExtrinsicEntry(method, creator) {\n    const decorated = (...params) => creator(method(...params)); // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n\n\n    return this._decorateFunctionMeta(method, decorated);\n  }\n\n  _decorateStorage(storage, decorateMethod) {\n    return Object.entries(storage).reduce((out, [name, section]) => {\n      out[name] = Object.entries(section).reduce((out, [name, method]) => {\n        out[name] = this._decorateStorageEntry(method, decorateMethod);\n        return out;\n      }, {});\n      return out;\n    }, {});\n  }\n\n  _decorateStorageEntry(creator, decorateMethod) {\n    // get the storage arguments, with DoubleMap as an array entry, otherwise spread\n    const getArgs = (...args) => (0, _validate.extractStorageArgs)(creator, args); // Disable this where it occurs for each field we are decorating\n\n    /* eslint-disable @typescript-eslint/no-unsafe-member-access,@typescript-eslint/no-unsafe-assignment */\n\n\n    const decorated = this._decorateStorageCall(creator, decorateMethod);\n\n    decorated.creator = creator;\n    decorated.at = decorateMethod((hash, arg1, arg2) => this._rpcCore.state.getStorage(getArgs(arg1, arg2), hash));\n    decorated.hash = decorateMethod((arg1, arg2) => this._rpcCore.state.getStorageHash(getArgs(arg1, arg2)));\n\n    decorated.key = (arg1, arg2) => (0, _util2.u8aToHex)((0, _util2.compactStripLength)(creator(creator.meta.type.isDoubleMap ? [arg1, arg2] : arg1))[1]);\n\n    decorated.keyPrefix = key1 => (0, _util2.u8aToHex)(creator.keyPrefix(key1));\n\n    decorated.range = decorateMethod((range, arg1, arg2) => this._decorateStorageRange(decorated, [arg1, arg2], range));\n    decorated.size = decorateMethod((arg1, arg2) => this._rpcCore.state.getStorageSize(getArgs(arg1, arg2))); // .keys() & .entries() only available on map types\n\n    if (creator.iterKey && (creator.meta.type.isMap || creator.meta.type.isDoubleMap)) {\n      decorated.entries = decorateMethod((0, _util.memo)((0, _classPrivateFieldLooseBase2.default)(this, _instanceId)[_instanceId], doubleMapArg => this._retrieveMapEntries(creator, doubleMapArg)));\n      decorated.entriesPaged = decorateMethod((0, _util.memo)((0, _classPrivateFieldLooseBase2.default)(this, _instanceId)[_instanceId], opts => this._retrieveMapEntriesPaged(creator, opts)));\n      decorated.keys = decorateMethod((0, _util.memo)((0, _classPrivateFieldLooseBase2.default)(this, _instanceId)[_instanceId], doubleMapArg => this._retrieveMapKeys(creator, doubleMapArg)));\n      decorated.keysPaged = decorateMethod((0, _util.memo)((0, _classPrivateFieldLooseBase2.default)(this, _instanceId)[_instanceId], opts => this._retrieveMapKeysPaged(creator, opts)));\n    } // only support multi where subs are available\n\n\n    if (this.hasSubscriptions) {\n      // When using double map storage function, user need to pass double map key as an array\n      decorated.multi = decorateMethod(args => this._rpcCore.state.subscribeStorage(args.map(arg => [creator, arg])));\n    }\n    /* eslint-enable @typescript-eslint/no-unsafe-member-access,@typescript-eslint/no-unsafe-assignment */\n\n\n    return this._decorateFunctionMeta(creator, decorated);\n  } // Decorate the base storage call. In the case or rxjs or promise-without-callback (await)\n  // we make a subscription, alternatively we push this through a single-shot query\n\n\n  _decorateStorageCall(creator, decorateMethod) {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n    return decorateMethod((...args) => {\n      return this.hasSubscriptions ? this._rpcCore.state.subscribeStorage([(0, _validate.extractStorageArgs)(creator, args)]).pipe((0, _operators.map)(([data]) => data) // extract first/only result from list\n      ) : this._rpcCore.state.getStorage((0, _validate.extractStorageArgs)(creator, args));\n    }, {\n      methodName: creator.method,\n      overrideNoSub: (...args) => this._rpcCore.state.getStorage((0, _validate.extractStorageArgs)(creator, args))\n    });\n  }\n\n  _decorateStorageRange(decorated, args, range) {\n    const outputType = (0, _StorageKey.unwrapStorageType)(decorated.creator.meta.type, decorated.creator.meta.modifier.isOptional);\n    return this._rpcCore.state.queryStorage([decorated.key(...args)], ...range).pipe((0, _operators.map)(result => result.map(([blockHash, [value]]) => [blockHash, this.createType(outputType, value.isSome ? value.unwrap().toHex() : undefined)])));\n  }\n\n  _retrieveMapKeys({\n    iterKey,\n    meta\n  }, arg) {\n    (0, _util2.assert)(iterKey && (meta.type.isMap || meta.type.isDoubleMap), 'keys can only be retrieved on maps, linked maps and double maps');\n    const headKey = iterKey(arg).toHex();\n    const startSubject = new _rxjs.BehaviorSubject(headKey);\n    return startSubject.pipe((0, _operators.switchMap)(startKey => this._rpcCore.state.getKeysPaged(headKey, PAGE_SIZE_KEYS, startKey).pipe((0, _operators.map)(keys => keys.map(key => key.setMeta(meta))))), (0, _operators.tap)(keys => {\n      keys.length === PAGE_SIZE_KEYS ? startSubject.next(keys[PAGE_SIZE_KEYS - 1].toHex()) : startSubject.complete();\n    }), (0, _operators.toArray)(), // toArray since we want to startSubject to be completed\n    (0, _operators.map)(keysArr => keysArr.reduce((result, keys) => result.concat(keys), [])));\n  }\n\n  _retrieveMapKeysPaged({\n    iterKey,\n    meta\n  }, opts) {\n    (0, _util2.assert)(iterKey && (meta.type.isMap || meta.type.isDoubleMap), 'keys can only be retrieved on maps, linked maps and double maps');\n    const headKey = iterKey(opts.arg).toHex();\n    return this._rpcCore.state.getKeysPaged(headKey, opts.pageSize, opts.startKey || headKey).pipe((0, _operators.map)(keys => keys.map(key => key.setMeta(meta))));\n  }\n\n  _retrieveMapEntries(entry, arg) {\n    return this._retrieveMapKeys(entry, arg).pipe((0, _operators.switchMap)(keys => (0, _rxjs.combineLatest)([(0, _rxjs.of)(keys), ...Array(Math.ceil(keys.length / PAGE_SIZE_VALS)).fill(0).map((_, index) => {\n      const keyset = keys.slice(index * PAGE_SIZE_VALS, index * PAGE_SIZE_VALS + PAGE_SIZE_VALS);\n      return this._rpcCore.state.queryStorageAt ? this._rpcCore.state.queryStorageAt(keyset) // this is horrible, but need older support\n      : this._rpcCore.state.subscribeStorage(keyset).pipe((0, _operators.take)(1));\n    })])), (0, _operators.map)(([keys, ...valsArr]) => valsArr.reduce((result, vals) => result.concat(vals), []).map((value, index) => [keys[index], value])));\n  }\n\n  _retrieveMapEntriesPaged(entry, opts) {\n    return this._retrieveMapKeysPaged(entry, opts).pipe((0, _operators.switchMap)(keys => (0, _rxjs.combineLatest)([(0, _rxjs.of)(keys), this._rpcCore.state.queryStorageAt(keys)])), (0, _operators.map)(([keys, ...valsArr]) => valsArr.reduce((result, vals) => result.concat(vals), []).map((value, index) => [keys[index], value])));\n  }\n\n  _decorateDeriveRx(decorateMethod) {\n    // Pull in derive from api-derive\n    const derive = (0, _apiDerive.default)((0, _classPrivateFieldLooseBase2.default)(this, _instanceId)[_instanceId], this._rx, this._options.derives);\n    return (0, _decorate.decorateSections)(derive, decorateMethod);\n  }\n\n  _decorateDerive(decorateMethod) {\n    return (0, _decorate.decorateSections)(this._rx.derive, decorateMethod);\n  }\n  /**\n   * Put the `this.onCall` function of ApiRx here, because it is needed by\n   * `api._rx`.\n   */\n\n\n}\n\nexports.default = Decorate;","map":{"version":3,"sources":["/home/robin/substrate-front-end-template/node_modules/@polkadot/api/base/Decorate.js"],"names":["_interopRequireDefault","require","Object","defineProperty","exports","value","default","_classPrivateFieldLooseBase2","_classPrivateFieldLooseKey2","_bn","_rxjs","_operators","_apiDerive","_util","_Decorated","_rpcCore","_rpcProvider","_types","_constants","_StorageKey","_util2","_submittable","_augmentObject","_decorate","_validate","_Events","PAGE_SIZE_KEYS","PAGE_SIZE_VALS","l","logger","instanceCounter","_instanceId","_registry","Decorate","constructor","options","type","decorateMethod","_options$source","writable","__phantom","_consts","_derive","_extrinsics","_extrinsicType","DEFAULT_VERSION","_genesisHash","_isConnected","_isReady","_options","_query","_queryMulti","_rpc","_runtimeChain","_runtimeMetadata","_runtimeVersion","_rx","consts","query","tx","_type","_decorateMethod","_rxDecorateMethod","method","source","registry","TypeRegistry","thisProvider","provider","clone","WsProvider","rpc","BehaviorSubject","isConnected","hasSubscriptions","createType","params","registerTypes","types","register","injectMetadata","metadata","fromEmpty","decoratedMeta","_decorateExtrinsics","_decorateStorage","_decorateFunctionMeta","input","output","meta","section","toJSON","callIndex","_filterRpc","methods","toPromise","map","t","toString","error","_filterRpcMethods","exposed","hasResults","length","allKnown","mapping","entries","allKeys","reduce","alias","pubsub","push","unknown","filter","key","includes","warn","join","forEach","_","_decorateRpc","sections","out","_sectionName","sectionName","methodName","startsWith","raw","_decorateMulti","calls","state","subscribeStorage","arg","Array","isArray","creator","slice","extrinsics","createSubmittable","name","_decorateExtrinsicEntry","decorated","storage","_decorateStorageEntry","getArgs","args","extractStorageArgs","_decorateStorageCall","at","hash","arg1","arg2","getStorage","getStorageHash","u8aToHex","compactStripLength","isDoubleMap","keyPrefix","key1","range","_decorateStorageRange","size","getStorageSize","iterKey","isMap","memo","doubleMapArg","_retrieveMapEntries","entriesPaged","opts","_retrieveMapEntriesPaged","keys","_retrieveMapKeys","keysPaged","_retrieveMapKeysPaged","multi","pipe","data","overrideNoSub","outputType","unwrapStorageType","modifier","isOptional","queryStorage","result","blockHash","isSome","unwrap","toHex","undefined","assert","headKey","startSubject","switchMap","startKey","getKeysPaged","setMeta","tap","next","complete","toArray","keysArr","concat","pageSize","entry","combineLatest","of","Math","ceil","fill","index","keyset","queryStorageAt","take","valsArr","vals","_decorateDeriveRx","derive","derives","decorateSections","_decorateDerive"],"mappings":"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","sourcesContent":["\"use strict\";\n\nvar _interopRequireDefault = require(\"@babel/runtime/helpers/interopRequireDefault\");\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.default = void 0;\n\nvar _classPrivateFieldLooseBase2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classPrivateFieldLooseBase\"));\n\nvar _classPrivateFieldLooseKey2 = _interopRequireDefault(require(\"@babel/runtime/helpers/classPrivateFieldLooseKey\"));\n\nvar _bn = _interopRequireDefault(require(\"bn.js\"));\n\nvar _rxjs = require(\"rxjs\");\n\nvar _operators = require(\"rxjs/operators\");\n\nvar _apiDerive = _interopRequireDefault(require(\"@polkadot/api-derive\"));\n\nvar _util = require(\"@polkadot/api-derive/util\");\n\nvar _Decorated = _interopRequireDefault(require(\"@polkadot/metadata/Decorated\"));\n\nvar _rpcCore = _interopRequireDefault(require(\"@polkadot/rpc-core\"));\n\nvar _rpcProvider = require(\"@polkadot/rpc-provider\");\n\nvar _types = require(\"@polkadot/types\");\n\nvar _constants = require(\"@polkadot/types/extrinsic/constants\");\n\nvar _StorageKey = require(\"@polkadot/types/primitive/StorageKey\");\n\nvar _util2 = require(\"@polkadot/util\");\n\nvar _submittable = require(\"../submittable\");\n\nvar _augmentObject = _interopRequireDefault(require(\"../util/augmentObject\"));\n\nvar _decorate = require(\"../util/decorate\");\n\nvar _validate = require(\"../util/validate\");\n\nvar _Events = _interopRequireDefault(require(\"./Events\"));\n\n// Copyright 2017-2020 @polkadot/api authors & contributors\n// SPDX-License-Identifier: Apache-2.0\nconst PAGE_SIZE_KEYS = 256;\nconst PAGE_SIZE_VALS = PAGE_SIZE_KEYS;\nconst l = (0, _util2.logger)('api/init');\nlet instanceCounter = 0;\n\nvar _instanceId = (0, _classPrivateFieldLooseKey2.default)(\"instanceId\");\n\nvar _registry = (0, _classPrivateFieldLooseKey2.default)(\"registry\");\n\nclass Decorate extends _Events.default {\n  // HACK Use BN import so decorateDerive works... yes, wtf.\n\n  /**\n   * This is the one and only method concrete children classes need to implement.\n   * It's a higher-order function, which takes one argument\n   * `method: Method extends (...args: any[]) => Observable<any>`\n   * (and one optional `options`), and should return the user facing method.\n   * For example:\n   * - For ApiRx, `decorateMethod` should just be identity, because the input\n   * function is already an Observable\n   * - For ApiPromise, `decorateMethod` should return a function that takes all\n   * the parameters from `method`, adds an optional `callback` argument, and\n   * returns a Promise.\n   *\n   * We could easily imagine other user-facing interfaces, which are simply\n   * implemented by transforming the Observable to Stream/Iterator/Kefir/Bacon\n   * via `decorateMethod`.\n   */\n\n  /**\n   * @description Create an instance of the class\n   *\n   * @param options Options object to create API instance or a Provider instance\n   *\n   * @example\n   * <BR>\n   *\n   * ```javascript\n   * import Api from '@polkadot/api/promise';\n   *\n   * const api = new Api().isReady();\n   *\n   * api.rpc.subscribeNewHeads((header) => {\n   *   console.log(`new block #${header.number.toNumber()}`);\n   * });\n   * ```\n   */\n  constructor(options, type, decorateMethod) {\n    var _options$source;\n\n    super();\n    Object.defineProperty(this, _instanceId, {\n      writable: true,\n      value: void 0\n    });\n    Object.defineProperty(this, _registry, {\n      writable: true,\n      value: void 0\n    });\n    this.__phantom = new _bn.default(0);\n    this._consts = {};\n    this._derive = void 0;\n    this._extrinsics = void 0;\n    this._extrinsicType = _constants.DEFAULT_VERSION;\n    this._genesisHash = void 0;\n    this._isConnected = void 0;\n    this._isReady = false;\n    this._options = void 0;\n    this._query = {};\n    this._queryMulti = void 0;\n    this._rpc = void 0;\n    this._rpcCore = void 0;\n    this._runtimeChain = void 0;\n    this._runtimeMetadata = void 0;\n    this._runtimeVersion = void 0;\n    this._rx = {\n      consts: {},\n      query: {},\n      tx: {}\n    };\n    this._type = void 0;\n    this._decorateMethod = void 0;\n\n    this._rxDecorateMethod = method => {\n      return method;\n    };\n\n    (0, _classPrivateFieldLooseBase2.default)(this, _instanceId)[_instanceId] = `${++instanceCounter}`;\n    (0, _classPrivateFieldLooseBase2.default)(this, _registry)[_registry] = ((_options$source = options.source) === null || _options$source === void 0 ? void 0 : _options$source.registry) || options.registry || new _types.TypeRegistry();\n    const thisProvider = options.source ? options.source._rpcCore.provider.clone() : options.provider || new _rpcProvider.WsProvider();\n    this._decorateMethod = decorateMethod;\n    this._options = options;\n    this._type = type;\n    this._rpcCore = new _rpcCore.default((0, _classPrivateFieldLooseBase2.default)(this, _instanceId)[_instanceId], (0, _classPrivateFieldLooseBase2.default)(this, _registry)[_registry], thisProvider, this._options.rpc);\n    this._isConnected = new _rxjs.BehaviorSubject(this._rpcCore.provider.isConnected);\n    this._rx.hasSubscriptions = this._rpcCore.provider.hasSubscriptions;\n    this._rx.registry = (0, _classPrivateFieldLooseBase2.default)(this, _registry)[_registry];\n  }\n  /**\n   * @description Return the current used registry\n   */\n\n\n  get registry() {\n    return (0, _classPrivateFieldLooseBase2.default)(this, _registry)[_registry];\n  }\n  /**\n   * @description Creates an instance of a type as registered\n   */\n\n\n  createType(type, ...params) {\n    return (0, _classPrivateFieldLooseBase2.default)(this, _registry)[_registry].createType(type, ...params);\n  }\n  /**\n   * @description Register additional user-defined of chain-specific types in the type registry\n   */\n\n\n  registerTypes(types) {\n    types && (0, _classPrivateFieldLooseBase2.default)(this, _registry)[_registry].register(types);\n  }\n  /**\n   * @returns `true` if the API operates with subscriptions\n   */\n\n\n  get hasSubscriptions() {\n    return this._rpcCore.provider.hasSubscriptions;\n  }\n\n  injectMetadata(metadata, fromEmpty, registry) {\n    const decoratedMeta = new _Decorated.default(registry || (0, _classPrivateFieldLooseBase2.default)(this, _registry)[_registry], metadata);\n\n    if (fromEmpty || !this._extrinsics) {\n      this._extrinsics = this._decorateExtrinsics(decoratedMeta.tx, this._decorateMethod);\n      this._rx.tx = this._decorateExtrinsics(decoratedMeta.tx, this._rxDecorateMethod);\n    } else {\n      (0, _augmentObject.default)('tx', this._decorateExtrinsics(decoratedMeta.tx, this._decorateMethod), this._extrinsics, false);\n      (0, _augmentObject.default)(null, this._decorateExtrinsics(decoratedMeta.tx, this._rxDecorateMethod), this._rx.tx, false);\n    } // this API\n\n\n    (0, _augmentObject.default)('query', this._decorateStorage(decoratedMeta.query, this._decorateMethod), this._query, fromEmpty);\n    (0, _augmentObject.default)('consts', decoratedMeta.consts, this._consts, fromEmpty); // rx\n\n    (0, _augmentObject.default)(null, this._decorateStorage(decoratedMeta.query, this._rxDecorateMethod), this._rx.query, fromEmpty);\n    (0, _augmentObject.default)(null, decoratedMeta.consts, this._rx.consts, fromEmpty);\n  }\n\n  _decorateFunctionMeta(input, output) {\n    output.meta = input.meta;\n    output.method = input.method;\n    output.section = input.section;\n    output.toJSON = input.toJSON;\n\n    if (input.callIndex) {\n      output.callIndex = input.callIndex;\n    }\n\n    return output;\n  } // Filter all RPC methods based on the results of the rpc_methods call. We do this in the following\n  // manner to cater for both old and new:\n  //   - when the number of entries are 0, only remove the ones with isOptional (account & contracts)\n  //   - when non-zero, remove anything that is not in the array (we don't do this)\n\n\n  async _filterRpc() {\n    let methods;\n\n    try {\n      // we ignore the version (adjust as versions change, for now only \"1\")\n      methods = (await this._rpcCore.rpc.methods().toPromise()).methods.map(t => t.toString());\n    } catch (error) {\n      // the method is not there, we adjust accordingly\n      methods = [];\n    }\n\n    this._filterRpcMethods(methods);\n  }\n\n  _filterRpcMethods(exposed) {\n    const hasResults = exposed.length !== 0;\n    const allKnown = [...this._rpcCore.mapping.entries()];\n    const allKeys = allKnown.reduce((allKeys, [, {\n      alias,\n      method,\n      pubsub,\n      section\n    }]) => {\n      allKeys.push(`${section}_${method}`);\n\n      if (pubsub) {\n        allKeys.push(`${section}_${pubsub[1]}`);\n        allKeys.push(`${section}_${pubsub[2]}`);\n      }\n\n      if (alias) {\n        allKeys.push(...alias);\n      }\n\n      return allKeys;\n    }, []);\n    const unknown = exposed.filter(key => !allKeys.includes(key));\n\n    if (unknown.length) {\n      l.warn(`RPC methods not decorated: ${unknown.join(', ')}`);\n    } // loop through all entries we have (populated in decorate) and filter as required\n    // only remove when we have results and method missing, or with no results if optional\n\n\n    allKnown.filter(([key]) => hasResults ? !exposed.includes(key) && key !== 'rpc_methods' // rpc_methods doesn't appear, v1\n    : key === 'rpc_methods' // we didn't find this one, remove\n    ) // eslint-disable-next-line @typescript-eslint/no-unused-vars\n    .forEach(([_, {\n      method,\n      section\n    }]) => {\n      delete this._rpc[section][method];\n      delete this._rpcCore[section][method];\n      delete this._rx.rpc[section][method];\n    });\n  }\n\n  _decorateRpc(rpc, decorateMethod) {\n    return rpc.sections.reduce((out, _sectionName) => {\n      const sectionName = _sectionName; // out and section here are horrors to get right from a typing perspective :(\n\n      out[sectionName] = Object.entries(rpc[sectionName]).reduce((section, [methodName, method]) => {\n        //  skip subscriptions where we have a non-subscribe interface\n        if (this.hasSubscriptions || !(methodName.startsWith('subscribe') || methodName.startsWith('unsubscribe'))) {\n          section[methodName] = decorateMethod(method, {\n            methodName\n          }); // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n\n          section[methodName].raw = decorateMethod(method.raw, {\n            methodName\n          });\n        }\n\n        return section;\n      }, {});\n      return out;\n    }, {});\n  }\n\n  _decorateMulti(decorateMethod) {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n    return decorateMethod(calls => this._rpcCore.state.subscribeStorage(calls.map(arg => // the input is a QueryableStorageEntry, convert to StorageEntry\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n    Array.isArray(arg) ? [arg[0].creator, ...arg.slice(1)] : [arg.creator])));\n  }\n\n  _decorateExtrinsics(extrinsics, decorateMethod) {\n    const creator = (0, _submittable.createSubmittable)(this._type, this._rx, decorateMethod);\n    return Object.entries(extrinsics).reduce((out, [name, section]) => {\n      out[name] = Object.entries(section).reduce((out, [name, method]) => {\n        out[name] = this._decorateExtrinsicEntry(method, creator);\n        return out;\n      }, {});\n      return out;\n    }, creator);\n  }\n\n  _decorateExtrinsicEntry(method, creator) {\n    const decorated = (...params) => creator(method(...params)); // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n\n\n    return this._decorateFunctionMeta(method, decorated);\n  }\n\n  _decorateStorage(storage, decorateMethod) {\n    return Object.entries(storage).reduce((out, [name, section]) => {\n      out[name] = Object.entries(section).reduce((out, [name, method]) => {\n        out[name] = this._decorateStorageEntry(method, decorateMethod);\n        return out;\n      }, {});\n      return out;\n    }, {});\n  }\n\n  _decorateStorageEntry(creator, decorateMethod) {\n    // get the storage arguments, with DoubleMap as an array entry, otherwise spread\n    const getArgs = (...args) => (0, _validate.extractStorageArgs)(creator, args); // Disable this where it occurs for each field we are decorating\n\n    /* eslint-disable @typescript-eslint/no-unsafe-member-access,@typescript-eslint/no-unsafe-assignment */\n\n\n    const decorated = this._decorateStorageCall(creator, decorateMethod);\n\n    decorated.creator = creator;\n    decorated.at = decorateMethod((hash, arg1, arg2) => this._rpcCore.state.getStorage(getArgs(arg1, arg2), hash));\n    decorated.hash = decorateMethod((arg1, arg2) => this._rpcCore.state.getStorageHash(getArgs(arg1, arg2)));\n\n    decorated.key = (arg1, arg2) => (0, _util2.u8aToHex)((0, _util2.compactStripLength)(creator(creator.meta.type.isDoubleMap ? [arg1, arg2] : arg1))[1]);\n\n    decorated.keyPrefix = key1 => (0, _util2.u8aToHex)(creator.keyPrefix(key1));\n\n    decorated.range = decorateMethod((range, arg1, arg2) => this._decorateStorageRange(decorated, [arg1, arg2], range));\n    decorated.size = decorateMethod((arg1, arg2) => this._rpcCore.state.getStorageSize(getArgs(arg1, arg2))); // .keys() & .entries() only available on map types\n\n    if (creator.iterKey && (creator.meta.type.isMap || creator.meta.type.isDoubleMap)) {\n      decorated.entries = decorateMethod((0, _util.memo)((0, _classPrivateFieldLooseBase2.default)(this, _instanceId)[_instanceId], doubleMapArg => this._retrieveMapEntries(creator, doubleMapArg)));\n      decorated.entriesPaged = decorateMethod((0, _util.memo)((0, _classPrivateFieldLooseBase2.default)(this, _instanceId)[_instanceId], opts => this._retrieveMapEntriesPaged(creator, opts)));\n      decorated.keys = decorateMethod((0, _util.memo)((0, _classPrivateFieldLooseBase2.default)(this, _instanceId)[_instanceId], doubleMapArg => this._retrieveMapKeys(creator, doubleMapArg)));\n      decorated.keysPaged = decorateMethod((0, _util.memo)((0, _classPrivateFieldLooseBase2.default)(this, _instanceId)[_instanceId], opts => this._retrieveMapKeysPaged(creator, opts)));\n    } // only support multi where subs are available\n\n\n    if (this.hasSubscriptions) {\n      // When using double map storage function, user need to pass double map key as an array\n      decorated.multi = decorateMethod(args => this._rpcCore.state.subscribeStorage(args.map(arg => [creator, arg])));\n    }\n    /* eslint-enable @typescript-eslint/no-unsafe-member-access,@typescript-eslint/no-unsafe-assignment */\n\n\n    return this._decorateFunctionMeta(creator, decorated);\n  } // Decorate the base storage call. In the case or rxjs or promise-without-callback (await)\n  // we make a subscription, alternatively we push this through a single-shot query\n\n\n  _decorateStorageCall(creator, decorateMethod) {\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-return\n    return decorateMethod((...args) => {\n      return this.hasSubscriptions ? this._rpcCore.state.subscribeStorage([(0, _validate.extractStorageArgs)(creator, args)]).pipe((0, _operators.map)(([data]) => data) // extract first/only result from list\n      ) : this._rpcCore.state.getStorage((0, _validate.extractStorageArgs)(creator, args));\n    }, {\n      methodName: creator.method,\n      overrideNoSub: (...args) => this._rpcCore.state.getStorage((0, _validate.extractStorageArgs)(creator, args))\n    });\n  }\n\n  _decorateStorageRange(decorated, args, range) {\n    const outputType = (0, _StorageKey.unwrapStorageType)(decorated.creator.meta.type, decorated.creator.meta.modifier.isOptional);\n    return this._rpcCore.state.queryStorage([decorated.key(...args)], ...range).pipe((0, _operators.map)(result => result.map(([blockHash, [value]]) => [blockHash, this.createType(outputType, value.isSome ? value.unwrap().toHex() : undefined)])));\n  }\n\n  _retrieveMapKeys({\n    iterKey,\n    meta\n  }, arg) {\n    (0, _util2.assert)(iterKey && (meta.type.isMap || meta.type.isDoubleMap), 'keys can only be retrieved on maps, linked maps and double maps');\n    const headKey = iterKey(arg).toHex();\n    const startSubject = new _rxjs.BehaviorSubject(headKey);\n    return startSubject.pipe((0, _operators.switchMap)(startKey => this._rpcCore.state.getKeysPaged(headKey, PAGE_SIZE_KEYS, startKey).pipe((0, _operators.map)(keys => keys.map(key => key.setMeta(meta))))), (0, _operators.tap)(keys => {\n      keys.length === PAGE_SIZE_KEYS ? startSubject.next(keys[PAGE_SIZE_KEYS - 1].toHex()) : startSubject.complete();\n    }), (0, _operators.toArray)(), // toArray since we want to startSubject to be completed\n    (0, _operators.map)(keysArr => keysArr.reduce((result, keys) => result.concat(keys), [])));\n  }\n\n  _retrieveMapKeysPaged({\n    iterKey,\n    meta\n  }, opts) {\n    (0, _util2.assert)(iterKey && (meta.type.isMap || meta.type.isDoubleMap), 'keys can only be retrieved on maps, linked maps and double maps');\n    const headKey = iterKey(opts.arg).toHex();\n    return this._rpcCore.state.getKeysPaged(headKey, opts.pageSize, opts.startKey || headKey).pipe((0, _operators.map)(keys => keys.map(key => key.setMeta(meta))));\n  }\n\n  _retrieveMapEntries(entry, arg) {\n    return this._retrieveMapKeys(entry, arg).pipe((0, _operators.switchMap)(keys => (0, _rxjs.combineLatest)([(0, _rxjs.of)(keys), ...Array(Math.ceil(keys.length / PAGE_SIZE_VALS)).fill(0).map((_, index) => {\n      const keyset = keys.slice(index * PAGE_SIZE_VALS, index * PAGE_SIZE_VALS + PAGE_SIZE_VALS);\n      return this._rpcCore.state.queryStorageAt ? this._rpcCore.state.queryStorageAt(keyset) // this is horrible, but need older support\n      : this._rpcCore.state.subscribeStorage(keyset).pipe((0, _operators.take)(1));\n    })])), (0, _operators.map)(([keys, ...valsArr]) => valsArr.reduce((result, vals) => result.concat(vals), []).map((value, index) => [keys[index], value])));\n  }\n\n  _retrieveMapEntriesPaged(entry, opts) {\n    return this._retrieveMapKeysPaged(entry, opts).pipe((0, _operators.switchMap)(keys => (0, _rxjs.combineLatest)([(0, _rxjs.of)(keys), this._rpcCore.state.queryStorageAt(keys)])), (0, _operators.map)(([keys, ...valsArr]) => valsArr.reduce((result, vals) => result.concat(vals), []).map((value, index) => [keys[index], value])));\n  }\n\n  _decorateDeriveRx(decorateMethod) {\n    // Pull in derive from api-derive\n    const derive = (0, _apiDerive.default)((0, _classPrivateFieldLooseBase2.default)(this, _instanceId)[_instanceId], this._rx, this._options.derives);\n    return (0, _decorate.decorateSections)(derive, decorateMethod);\n  }\n\n  _decorateDerive(decorateMethod) {\n    return (0, _decorate.decorateSections)(this._rx.derive, decorateMethod);\n  }\n  /**\n   * Put the `this.onCall` function of ApiRx here, because it is needed by\n   * `api._rx`.\n   */\n\n\n}\n\nexports.default = Decorate;"]},"metadata":{},"sourceType":"script"}