{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.refCountDelay = refCountDelay;\n\nvar _rxjs = require(\"rxjs\"); // Copyright 2017-2020 @polkadot/rpc-core authors & contributors\n// SPDX-License-Identifier: Apache-2.0\n\n/** @internal */\n\n\nfunction refCountDelay(delay = 1750) {\n  return source => {\n    // state: 0 = disconnected, 1 = disconnecting, 2 = connecting, 3 = connected\n    let [state, refCount, connection, scheduler] = [0, 0, _rxjs.Subscription.EMPTY, _rxjs.Subscription.EMPTY];\n    return new _rxjs.Observable(ob => {\n      source.subscribe(ob);\n\n      if (refCount++ === 0) {\n        if (state === 1) {\n          scheduler.unsubscribe();\n        } else {\n          connection = source.connect();\n        }\n\n        state = 3;\n      }\n\n      return () => {\n        if (--refCount === 0) {\n          if (state === 2) {\n            state = 0;\n            scheduler.unsubscribe();\n          } else {\n            // state === 3\n            state = 1;\n            scheduler = _rxjs.asapScheduler.schedule(() => {\n              state = 0;\n              connection.unsubscribe();\n            }, delay);\n          }\n        }\n      };\n    });\n  };\n}","map":{"version":3,"sources":["/home/robin/substrate-front-end-template/node_modules/@polkadot/rpc-core/rxjs/refCountDelay.js"],"names":["Object","defineProperty","exports","value","refCountDelay","_rxjs","require","delay","source","state","refCount","connection","scheduler","Subscription","EMPTY","Observable","ob","subscribe","unsubscribe","connect","asapScheduler","schedule"],"mappings":"AAAA;;AAEAA,MAAM,CAACC,cAAP,CAAsBC,OAAtB,EAA+B,YAA/B,EAA6C;AAC3CC,EAAAA,KAAK,EAAE;AADoC,CAA7C;AAGAD,OAAO,CAACE,aAAR,GAAwBA,aAAxB;;AAEA,IAAIC,KAAK,GAAGC,OAAO,CAAC,MAAD,CAAnB,C,CAEA;AACA;;AAEA;;;AACA,SAASF,aAAT,CAAuBG,KAAK,GAAG,IAA/B,EAAqC;AACnC,SAAOC,MAAM,IAAI;AACf;AACA,QAAI,CAACC,KAAD,EAAQC,QAAR,EAAkBC,UAAlB,EAA8BC,SAA9B,IAA2C,CAAC,CAAD,EAAI,CAAJ,EAAOP,KAAK,CAACQ,YAAN,CAAmBC,KAA1B,EAAiCT,KAAK,CAACQ,YAAN,CAAmBC,KAApD,CAA/C;AACA,WAAO,IAAIT,KAAK,CAACU,UAAV,CAAqBC,EAAE,IAAI;AAChCR,MAAAA,MAAM,CAACS,SAAP,CAAiBD,EAAjB;;AAEA,UAAIN,QAAQ,OAAO,CAAnB,EAAsB;AACpB,YAAID,KAAK,KAAK,CAAd,EAAiB;AACfG,UAAAA,SAAS,CAACM,WAAV;AACD,SAFD,MAEO;AACLP,UAAAA,UAAU,GAAGH,MAAM,CAACW,OAAP,EAAb;AACD;;AAEDV,QAAAA,KAAK,GAAG,CAAR;AACD;;AAED,aAAO,MAAM;AACX,YAAI,EAAEC,QAAF,KAAe,CAAnB,EAAsB;AACpB,cAAID,KAAK,KAAK,CAAd,EAAiB;AACfA,YAAAA,KAAK,GAAG,CAAR;AACAG,YAAAA,SAAS,CAACM,WAAV;AACD,WAHD,MAGO;AACL;AACAT,YAAAA,KAAK,GAAG,CAAR;AACAG,YAAAA,SAAS,GAAGP,KAAK,CAACe,aAAN,CAAoBC,QAApB,CAA6B,MAAM;AAC7CZ,cAAAA,KAAK,GAAG,CAAR;AACAE,cAAAA,UAAU,CAACO,WAAX;AACD,aAHW,EAGTX,KAHS,CAAZ;AAID;AACF;AACF,OAdD;AAeD,KA5BM,CAAP;AA6BD,GAhCD;AAiCD","sourcesContent":["\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\nexports.refCountDelay = refCountDelay;\n\nvar _rxjs = require(\"rxjs\");\n\n// Copyright 2017-2020 @polkadot/rpc-core authors & contributors\n// SPDX-License-Identifier: Apache-2.0\n\n/** @internal */\nfunction refCountDelay(delay = 1750) {\n  return source => {\n    // state: 0 = disconnected, 1 = disconnecting, 2 = connecting, 3 = connected\n    let [state, refCount, connection, scheduler] = [0, 0, _rxjs.Subscription.EMPTY, _rxjs.Subscription.EMPTY];\n    return new _rxjs.Observable(ob => {\n      source.subscribe(ob);\n\n      if (refCount++ === 0) {\n        if (state === 1) {\n          scheduler.unsubscribe();\n        } else {\n          connection = source.connect();\n        }\n\n        state = 3;\n      }\n\n      return () => {\n        if (--refCount === 0) {\n          if (state === 2) {\n            state = 0;\n            scheduler.unsubscribe();\n          } else {\n            // state === 3\n            state = 1;\n            scheduler = _rxjs.asapScheduler.schedule(() => {\n              state = 0;\n              connection.unsubscribe();\n            }, delay);\n          }\n        }\n      };\n    });\n  };\n}"]},"metadata":{},"sourceType":"script"}